# RBR Wave Data Analysis Script

This Python script processes and visualizes wave data collected by RBR sensors and exported using Ruskin software. It utilizes the `oceanlyz` library for wave statistics calculation and `matplotlib`/`seaborn` for plotting.

## Features

* **Mode 1: Process Raw Data:**
    * Extracts depth data from a raw CSV file exported from Ruskin.
    * Calculates wave statistics (Significant Wave Height - Hm0, Peak Period - Tp, Mean Period - Tm01, etc.) using spectral analysis via the `oceanlyz` library.
    * Saves calculated parameters (Hm0, Tp, Tm01, fp, f, Syy) into separate CSV files.
* **Mode 2: Plot Processed Data:**
    * Reads pre-calculated wave statistics from `Hs.csv`, `Tp.csv`, and `Tm01.csv`.
* **Both Modes:**
    * Combines wave parameters with timestamps (starting from a user-provided date/time).
    * Calculates an alternative Peak Period based on DNV-RP-C205 recommendations (using an estimated gamma value).
    * Generates and saves various plots as PNG files:
        * Time series plots (Hs, Tp, Calculated Tp, Tm).
        * Scatter plots (Hs vs Tp, Hs vs Calculated Tp, Hs vs Tm).
        * Histograms (Hs, Tp, Calculated Tp, Tm).
    * Creates a `Wave_data_vetted.csv` file containing dated wave parameters.
    * Creates a `Wave_analysis.txt` file listing the 10 highest significant wave heights recorded.

## Prerequisites

* Python 3.x
* Required Python Libraries:
    * `oceanlyz`
    * `numpy`
    * `matplotlib`
    * `pandas`
    * `seaborn`
* Input Data File(s) (depending on the mode selected).

## Installation

1.  **Clone the repository or download the script.**
2.  **Install required libraries:**
    ```bash
    pip install oceanlyz numpy matplotlib pandas seaborn
    ```

## Usage

1.  **Place the Python script** (`RBR.py`) in the same folder as your data file(s).
2.  **Run the script** from your terminal:
    ```bash
    python RBR.py
    ```
3.  **Follow the prompts:**
    * **Choose Mode:** Enter `1` to process raw data or `2` to plot existing processed data.
    * **Mode 1 Inputs:**
        * Enter the filename of the raw CSV exported from Ruskin (e.g., `ruskin_export.csv`).
        * Enter the sampling frequency in Hz.
        * Enter the desired burst duration in minutes (e.g., `30`).
    * **Mode 2 Prerequisite:** Ensure `Hs.csv`, `Tp.csv`, and `Tm01.csv` are present in the same folder.
    * **Both Modes Input:**
        * Enter the start date and time of the first data sample in the format `dd/mm/yyyy HH:MM:SS`.

## Input Files

* **Mode 1:** A CSV file exported from Ruskin software containing burst data. The script assumes the depth data is in the 4th column (index 3).
* **Mode 2:**
    * `Hs.csv`: CSV containing significant wave height values (one per burst).
    * `Tp.csv`: CSV containing peak period values (one per burst).
    * `Tm01.csv`: CSV containing mean period values (one per burst).

## Output Files

The script generates the following files in the same directory:

* **If Mode 1 is run:**
    * `outputb.csv`: Intermediate file with extracted depth data (temporary).
    * `inputfile.csv`: Cleaned depth data used by `oceanlyz`.
    * `Hs.csv`: Calculated significant wave heights.
    * `Tp.csv`: Calculated peak periods.
    * `Tm01.csv`: Calculated mean periods.
    * `fp.csv`: Calculated peak frequencies.
    * `f.csv`: Frequency bins.
    * `Syy.csv`: Wave energy spectra.
* **Generated by both modes (overwrites existing if run again):**
    * `Wave_data_vetted.csv`: Combined wave data (Hs, Tp, Tm, Calculated Tp) with timestamps.
    * `Wave_analysis.txt`: Text file with the 10 highest Hs values.
    * `sigWave.png`: Time series plot of Hs.
    * `peakP.png`: Time series plot of Tp.
    * `peakP_DNV_gamma4.png`: Time series plot of calculated Tp (DNV method).
    * `meanP.png`: Time series plot of Tm.
    * `hsPeakScatter.png`: Scatter plot of Hs vs Tp.
    * `hsPeakScatter_DNV_gamma4.png`: Scatter plot of Hs vs calculated Tp (DNV method).
    * `hsMeanScatter.png`: Scatter plot of Hs vs Tm.
    * `hsHistogram.png`: Histogram of Hs.
    * `peakPHistogram.png`: Histogram of Tp.
    * `peakPHistogram_DNV_gamma4.png`: Histogram of calculated Tp (DNV method).
    * `meanPHistogram.png`: Histogram of Tm.

## Notes

* Ensure you delete previously generated output files (`Wave_data_vetted.csv`, `Wave_analysis.txt`, and all `.png` files) before re-running the script in plotting mode (Mode 2 or after Mode 1 completes) to avoid potential errors or appending data incorrectly.
* The script assumes a default burst duration of 30 minutes when calculating timestamps. If your data uses a different interval, you may need to adjust the `timedelta(minutes=30)` part in the code.
* The DNV-based Tp calculation uses a hardcoded `gamma` value of 4. This might need adjustment based on specific sea state characteristics.
* The script extracts depth from the 4th column (`row[3]`) of the Ruskin CSV. Verify this matches your export format.

